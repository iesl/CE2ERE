2021-07-24 12:24:33,955 [INFO] {'data_dir': '../data', 'no_cuda': False, 'debug': True, 'log_batch_size': 7, 'epochs': 10, 'data_type': 'hieve', 'finetune': False, 'model': 'box', 'downsample': 0.01, 'learning_rate': 0.01, 'lambda_anno': 1.0, 'lambda_trans': 0.0, 'lambda_cross': 0.0, 'lambda_pair': 1.0, 'volume_temp': 1.0, 'intersection_temp': 0.0001, 'hieve_threshold': -0.6, 'matres_threshold': -0.5, 'mlp_size': 32, 'mlp_output_dim': 32, 'hieve_mlp_size': 64, 'matres_mlp_size': 32, 'proj_output_dim': 32, 'num_layers': 1, 'roberta_hidden_size': 1024, 'lstm_hidden_size': 256, 'lstm_input_size': 768, 'no_valid': False, 'loss_type': 1, 'patience': 8, 'eval_step': 1, 'eval_type': 'one', 'load_model': 0, 'saved_model': '/Users/ehwang/PycharmProjects/CE2ERE/src/model/matres_20210505163300_2ya6wb7v.pt', 'wandb_id': 'hwang7520/CE2ERE-src/2ya6wb7v', 'load_valid': 0, 'save_plot': 1, 'symm_train': 0, 'symm_eval': 0, 'cv_valid': 0, 'model_save': 0, 'fix_seed': 0}
2021-07-24 12:24:33,955 [INFO] Requested CUDA but it is not available, running on CPU
2021-07-24 12:25:11,505 [INFO] HiEve Preprocessing took 0:00:38
2021-07-24 12:25:11,506 [INFO] HiEve training instance num: 7113, valid instance num: 7886, test instance num: 4238, cv-valid instance num: 13007, cv-test instance num: 6602, 
2021-07-24 12:25:11,506 [INFO] debug mode on
2021-07-24 12:25:11,702 [INFO] hieve length debugging mode: %d
2021-07-24 12:25:12,779 [INFO] loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-config.json from cache at /Users/ehwang/.cache/torch/transformers/e1a2a406b5a05063c31f4dfdee7608986ba7c6393f7f79db5e69dcd197208534.117c81977c5979de8c088352e74ec6e70f5c66096c28b61d3c50101609b39690
2021-07-24 12:25:12,779 [INFO] Model config RobertaConfig {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-07-24 12:25:13,650 [INFO] loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-pytorch_model.bin from cache at /Users/ehwang/.cache/torch/transformers/228756ed15b6d200d7cb45aaef08c087e2706f54cb912863d2efe07c89584eb7.49b88ba7ec2c26a7558dda98ca3884c3b80fa31cf43a1b1f23aef3ff81ba344e
2021-07-24 12:25:16,403 [INFO] ======== Epoch 1 / 10 ========
2021-07-24 12:25:16,403 [INFO] Training start...
2021-07-24 12:26:03,237 [INFO] epoch: 1, loss: 307.920410
2021-07-24 12:26:03,238 [INFO] [valid-hieve] start... 
2021-07-24 12:26:46,085 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 4  0  0  4]
 [83  0  0  5]
 [ 3  0  0  0]]
2021-07-24 12:26:46,102 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00       1.0
          01       0.00      0.00      0.00       8.0
          10       0.00      0.00      0.00      88.0
          11       0.00      0.00      0.00       3.0

    accuracy                           0.00     100.0
   macro avg       0.00      0.00      0.00     100.0
weighted avg       0.00      0.00      0.00     100.0

2021-07-24 12:26:46,102 [INFO] macro f1 score: 0.0000
2021-07-24 12:26:46,102 [INFO] done!
2021-07-24 12:26:46,396 [INFO] # of 10 labels: 88
2021-07-24 12:26:46,622 [INFO] # of 01 labels: 8
2021-07-24 12:26:46,837 [INFO] # of 11 labels: 3
2021-07-24 12:26:47,046 [INFO] # of 00 labels: 1
2021-07-24 12:26:47,046 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.0, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 42.86439299583435}
2021-07-24 12:26:47,046 [INFO] cv_valid_metrics: {}
2021-07-24 12:26:47,047 [INFO] ======== Epoch 2 / 10 ========
2021-07-24 12:26:47,047 [INFO] Training start...
2021-07-24 12:27:31,166 [INFO] epoch: 2, loss: 1400.400391
2021-07-24 12:27:31,168 [INFO] [valid-hieve] start... 
2021-07-24 12:28:09,668 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 0  3  0  5]
 [74  3  2  9]
 [ 0  0  0  3]]
2021-07-24 12:28:09,675 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.50      0.38      0.43         8
          10       1.00      0.02      0.04        88
          11       0.17      1.00      0.29         3

    accuracy                           0.08       100
   macro avg       0.42      0.35      0.19       100
weighted avg       0.93      0.08      0.08       100

2021-07-24 12:28:09,676 [INFO] macro f1 score: 0.2365
2021-07-24 12:28:09,676 [INFO] done!
2021-07-24 12:28:09,872 [INFO] # of 10 labels: 88
2021-07-24 12:28:10,075 [INFO] # of 01 labels: 8
2021-07-24 12:28:10,266 [INFO] # of 11 labels: 3
2021-07-24 12:28:10,450 [INFO] # of 00 labels: 1
2021-07-24 12:28:10,450 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.3076923076923077, '[valid-hieve] Recall': 0.08080808080808081, '[valid-hieve] F1 Score': 0.128, '[valid] Elapsed Time': 38.50786590576172}
2021-07-24 12:28:10,450 [INFO] cv_valid_metrics: {}
2021-07-24 12:28:10,451 [INFO] best epoch: 2, best f1 score: 0.128000
2021-07-24 12:28:10,451 [INFO] ======== Epoch 3 / 10 ========
2021-07-24 12:28:10,451 [INFO] Training start...
2021-07-24 12:28:53,726 [INFO] epoch: 3, loss: 815.442261
2021-07-24 12:28:53,728 [INFO] [valid-hieve] start... 
2021-07-24 12:29:30,605 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 0  1  0  7]
 [72  0  8  8]
 [ 0  0  0  3]]
2021-07-24 12:29:30,612 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       1.00      0.12      0.22         8
          10       1.00      0.09      0.17        88
          11       0.16      1.00      0.27         3

    accuracy                           0.12       100
   macro avg       0.54      0.30      0.17       100
weighted avg       0.96      0.12      0.17       100

2021-07-24 12:29:30,613 [INFO] macro f1 score: 0.1944
2021-07-24 12:29:30,613 [INFO] done!
2021-07-24 12:29:30,826 [INFO] # of 10 labels: 88
2021-07-24 12:29:31,030 [INFO] # of 01 labels: 8
2021-07-24 12:29:31,327 [INFO] # of 11 labels: 3
2021-07-24 12:29:31,518 [INFO] # of 00 labels: 1
2021-07-24 12:29:31,518 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.42857142857142855, '[valid-hieve] Recall': 0.12121212121212122, '[valid-hieve] F1 Score': 0.18897637795275593, '[valid] Elapsed Time': 36.885311126708984}
2021-07-24 12:29:31,518 [INFO] cv_valid_metrics: {}
2021-07-24 12:29:31,518 [INFO] best epoch: 3, best f1 score: 0.188976
2021-07-24 12:29:31,519 [INFO] ======== Epoch 4 / 10 ========
2021-07-24 12:29:31,519 [INFO] Training start...
2021-07-24 12:30:14,489 [INFO] epoch: 4, loss: 665.374695
2021-07-24 12:30:14,490 [INFO] [valid-hieve] start... 
2021-07-24 12:30:51,504 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 0  4  0  4]
 [55  0 17 16]
 [ 0  0  0  3]]
2021-07-24 12:30:51,511 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       1.00      0.50      0.67         8
          10       1.00      0.19      0.32        88
          11       0.12      1.00      0.22         3

    accuracy                           0.24       100
   macro avg       0.53      0.42      0.30       100
weighted avg       0.96      0.24      0.34       100

2021-07-24 12:30:51,511 [INFO] macro f1 score: 0.4952
2021-07-24 12:30:51,511 [INFO] done!
2021-07-24 12:30:51,724 [INFO] # of 10 labels: 88
2021-07-24 12:30:51,959 [INFO] # of 01 labels: 8
2021-07-24 12:30:52,178 [INFO] # of 11 labels: 3
2021-07-24 12:30:52,373 [INFO] # of 00 labels: 1
2021-07-24 12:30:52,373 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.5333333333333333, '[valid-hieve] Recall': 0.24242424242424243, '[valid-hieve] F1 Score': 0.3333333333333333, '[valid] Elapsed Time': 37.02114009857178}
2021-07-24 12:30:52,374 [INFO] cv_valid_metrics: {}
2021-07-24 12:30:52,374 [INFO] best epoch: 4, best f1 score: 0.333333
2021-07-24 12:30:52,374 [INFO] ======== Epoch 5 / 10 ========
2021-07-24 12:30:52,374 [INFO] Training start...
2021-07-24 12:31:34,193 [INFO] epoch: 5, loss: 447.194183
2021-07-24 12:31:34,194 [INFO] [valid-hieve] start... 
2021-07-24 12:32:10,450 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 0  7  0  1]
 [21  0 44 23]
 [ 0  2  0  1]]
2021-07-24 12:32:10,457 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.78      0.88      0.82         8
          10       1.00      0.50      0.67        88
          11       0.04      0.33      0.07         3

    accuracy                           0.52       100
   macro avg       0.45      0.43      0.39       100
weighted avg       0.94      0.52      0.65       100

2021-07-24 12:32:10,457 [INFO] macro f1 score: 0.7451
2021-07-24 12:32:10,457 [INFO] done!
2021-07-24 12:32:10,651 [INFO] # of 10 labels: 88
2021-07-24 12:32:10,865 [INFO] # of 01 labels: 8
2021-07-24 12:32:11,062 [INFO] # of 11 labels: 3
2021-07-24 12:32:11,249 [INFO] # of 00 labels: 1
2021-07-24 12:32:11,250 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.6582278481012658, '[valid-hieve] Recall': 0.5252525252525253, '[valid-hieve] F1 Score': 0.5842696629213483, '[valid] Elapsed Time': 36.26322889328003}
2021-07-24 12:32:11,250 [INFO] cv_valid_metrics: {}
2021-07-24 12:32:11,250 [INFO] best epoch: 5, best f1 score: 0.584270
2021-07-24 12:32:11,251 [INFO] ======== Epoch 6 / 10 ========
2021-07-24 12:32:11,251 [INFO] Training start...
2021-07-24 12:32:52,709 [INFO] epoch: 6, loss: 472.856323
2021-07-24 12:32:52,710 [INFO] [valid-hieve] start... 
2021-07-24 12:33:28,265 [INFO] confusion_matrix: 
[[ 0  0  0  1]
 [ 3  4  0  1]
 [34  0 54  0]
 [ 0  2  0  1]]
2021-07-24 12:33:28,272 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.67      0.50      0.57         8
          10       1.00      0.61      0.76        88
          11       0.33      0.33      0.33         3

    accuracy                           0.59       100
   macro avg       0.50      0.36      0.42       100
weighted avg       0.94      0.59      0.73       100

2021-07-24 12:33:28,272 [INFO] macro f1 score: 0.6660
2021-07-24 12:33:28,272 [INFO] done!
2021-07-24 12:33:28,477 [INFO] # of 10 labels: 88
2021-07-24 12:33:28,777 [INFO] # of 01 labels: 8
2021-07-24 12:33:28,973 [INFO] # of 11 labels: 3
2021-07-24 12:33:29,154 [INFO] # of 00 labels: 1
2021-07-24 12:33:29,154 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.9365079365079365, '[valid-hieve] Recall': 0.5959595959595959, '[valid-hieve] F1 Score': 0.7283950617283951, '[valid] Elapsed Time': 35.56189274787903}
2021-07-24 12:33:29,155 [INFO] cv_valid_metrics: {}
2021-07-24 12:33:29,155 [INFO] best epoch: 6, best f1 score: 0.728395
2021-07-24 12:33:29,155 [INFO] ======== Epoch 7 / 10 ========
2021-07-24 12:33:29,155 [INFO] Training start...
2021-07-24 12:34:10,704 [INFO] epoch: 7, loss: 302.153503
2021-07-24 12:34:10,705 [INFO] [valid-hieve] start... 
2021-07-24 12:34:46,266 [INFO] confusion_matrix: 
[[ 0  1  0  0]
 [ 3  3  1  1]
 [83  0  5  0]
 [ 0  0  1  2]]
2021-07-24 12:34:46,273 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.75      0.38      0.50         8
          10       0.71      0.06      0.11        88
          11       0.67      0.67      0.67         3

    accuracy                           0.10       100
   macro avg       0.53      0.27      0.32       100
weighted avg       0.71      0.10      0.15       100

2021-07-24 12:34:46,273 [INFO] macro f1 score: 0.3026
2021-07-24 12:34:46,273 [INFO] done!
2021-07-24 12:34:46,467 [INFO] # of 10 labels: 88
2021-07-24 12:34:46,705 [INFO] # of 01 labels: 8
2021-07-24 12:34:46,907 [INFO] # of 11 labels: 3
2021-07-24 12:34:47,100 [INFO] # of 00 labels: 1
2021-07-24 12:34:47,100 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.7142857142857143, '[valid-hieve] Recall': 0.10101010101010101, '[valid-hieve] F1 Score': 0.17699115044247787, '[valid] Elapsed Time': 35.567721128463745}
2021-07-24 12:34:47,100 [INFO] cv_valid_metrics: {}
2021-07-24 12:34:47,100 [INFO] ======== Epoch 8 / 10 ========
2021-07-24 12:34:47,101 [INFO] Training start...
2021-07-24 12:35:28,206 [INFO] epoch: 8, loss: 260.761108
2021-07-24 12:35:28,207 [INFO] [valid-hieve] start... 
2021-07-24 12:36:04,122 [INFO] confusion_matrix: 
[[ 0  1  0  0]
 [ 3  3  2  0]
 [85  0  3  0]
 [ 0  0  3  0]]
2021-07-24 12:36:04,129 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.75      0.38      0.50         8
          10       0.38      0.03      0.06        88
          11       0.00      0.00      0.00         3

    accuracy                           0.06       100
   macro avg       0.28      0.10      0.14       100
weighted avg       0.39      0.06      0.10       100

2021-07-24 12:36:04,129 [INFO] macro f1 score: 0.2812
2021-07-24 12:36:04,129 [INFO] done!
2021-07-24 12:36:04,342 [INFO] # of 10 labels: 88
2021-07-24 12:36:04,576 [INFO] # of 01 labels: 8
2021-07-24 12:36:04,777 [INFO] # of 11 labels: 3
2021-07-24 12:36:04,966 [INFO] # of 00 labels: 1
2021-07-24 12:36:04,966 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.5, '[valid-hieve] Recall': 0.06060606060606061, '[valid-hieve] F1 Score': 0.10810810810810813, '[valid] Elapsed Time': 35.92190504074097}
2021-07-24 12:36:04,966 [INFO] cv_valid_metrics: {}
2021-07-24 12:36:04,967 [INFO] ======== Epoch 9 / 10 ========
2021-07-24 12:36:04,967 [INFO] Training start...
2021-07-24 12:36:46,176 [INFO] epoch: 9, loss: 324.962708
2021-07-24 12:36:46,177 [INFO] [valid-hieve] start... 
2021-07-24 12:37:21,560 [INFO] confusion_matrix: 
[[ 0  1  0  0]
 [ 2  4  2  0]
 [79  0  9  0]
 [ 0  0  3  0]]
2021-07-24 12:37:21,568 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.80      0.50      0.62         8
          10       0.64      0.10      0.18        88
          11       0.00      0.00      0.00         3

    accuracy                           0.13       100
   macro avg       0.36      0.15      0.20       100
weighted avg       0.63      0.13      0.20       100

2021-07-24 12:37:21,568 [INFO] macro f1 score: 0.3959
2021-07-24 12:37:21,568 [INFO] done!
2021-07-24 12:37:21,867 [INFO] # of 10 labels: 88
2021-07-24 12:37:22,097 [INFO] # of 01 labels: 8
2021-07-24 12:37:22,299 [INFO] # of 11 labels: 3
2021-07-24 12:37:22,489 [INFO] # of 00 labels: 1
2021-07-24 12:37:22,490 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.6842105263157895, '[valid-hieve] Recall': 0.13131313131313133, '[valid-hieve] F1 Score': 0.22033898305084748, '[valid] Elapsed Time': 35.39091897010803}
2021-07-24 12:37:22,490 [INFO] cv_valid_metrics: {}
2021-07-24 12:37:22,491 [INFO] ======== Epoch 10 / 10 ========
2021-07-24 12:37:22,491 [INFO] Training start...
2021-07-24 12:38:03,478 [INFO] epoch: 10, loss: 366.165710
2021-07-24 12:38:03,480 [INFO] [valid-hieve] start... 
2021-07-24 12:38:39,025 [INFO] confusion_matrix: 
[[ 0  1  0  0]
 [ 0  6  2  0]
 [19  0 69  0]
 [ 0  0  3  0]]
2021-07-24 12:38:39,032 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.86      0.75      0.80         8
          10       0.93      0.78      0.85        88
          11       0.00      0.00      0.00         3

    accuracy                           0.75       100
   macro avg       0.45      0.38      0.41       100
weighted avg       0.89      0.75      0.81       100

2021-07-24 12:38:39,032 [INFO] macro f1 score: 0.8259
2021-07-24 12:38:39,032 [INFO] done!
2021-07-24 12:38:39,227 [INFO] # of 10 labels: 88
2021-07-24 12:38:39,414 [INFO] # of 01 labels: 8
2021-07-24 12:38:39,611 [INFO] # of 11 labels: 3
2021-07-24 12:38:39,795 [INFO] # of 00 labels: 1
2021-07-24 12:38:39,795 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.9259259259259259, '[valid-hieve] Recall': 0.7575757575757576, '[valid-hieve] F1 Score': 0.8333333333333334, '[valid] Elapsed Time': 35.552703857421875}
2021-07-24 12:38:39,795 [INFO] cv_valid_metrics: {}
2021-07-24 12:38:39,796 [INFO] best epoch: 10, best f1 score: 0.833333
2021-07-24 12:38:39,797 [INFO] [valid-hieve] start... 
2021-07-24 12:39:15,364 [INFO] confusion_matrix: 
[[ 0  1  0  0]
 [ 0  6  2  0]
 [19  0 69  0]
 [ 0  0  3  0]]
2021-07-24 12:39:15,371 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.00      0.00      0.00         1
          01       0.86      0.75      0.80         8
          10       0.93      0.78      0.85        88
          11       0.00      0.00      0.00         3

    accuracy                           0.75       100
   macro avg       0.45      0.38      0.41       100
weighted avg       0.89      0.75      0.81       100

2021-07-24 12:39:15,371 [INFO] macro f1 score: 0.8259
2021-07-24 12:39:15,371 [INFO] done!
2021-07-24 12:39:15,561 [INFO] # of 10 labels: 88
2021-07-24 12:39:15,755 [INFO] # of 01 labels: 8
2021-07-24 12:39:15,949 [INFO] # of 11 labels: 3
2021-07-24 12:39:16,228 [INFO] # of 00 labels: 1
2021-07-24 12:39:16,229 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.9259259259259259, '[valid-hieve] Recall': 0.7575757575757576, '[valid-hieve] F1 Score': 0.8333333333333334, '[valid] Elapsed Time': 35.57503533363342}
2021-07-24 12:39:16,229 [INFO] cv_valid_metrics: {}
2021-07-24 12:39:16,230 [INFO] Training done!
