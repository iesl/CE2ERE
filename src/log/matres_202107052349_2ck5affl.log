2021-07-05 23:49:44,893 [INFO] {'data_dir': '../data', 'no_cuda': False, 'debug': True, 'log_batch_size': 7, 'epochs': 10, 'data_type': 'matres', 'finetune': False, 'model': 'box', 'downsample': 0.0, 'learning_rate': 0.01, 'lambda_anno': 1.0, 'lambda_trans': 0.0, 'lambda_cross': 0.0, 'volume_temp': 1.0, 'intersection_temp': 0.0001, 'hieve_threshold': -0.6, 'matres_threshold': -0.5, 'mlp_size': 32, 'mlp_output_dim': 32, 'hieve_mlp_size': 64, 'matres_mlp_size': 32, 'proj_output_dim': 32, 'num_layers': 1, 'roberta_hidden_size': 1024, 'lstm_hidden_size': 256, 'lstm_input_size': 768, 'seed': 784637755, 'no_valid': False, 'loss_type': 0, 'patience': 8, 'eval_step': 1, 'eval_type': 'one', 'load_model': 0, 'saved_model': '/Users/ehwang/PycharmProjects/CE2ERE/src/model/matres_20210505163300_2ya6wb7v.pt', 'wandb_id': 'hwang7520/CE2ERE-src/2ya6wb7v', 'load_valid': 0, 'save_plot': 1, 'symm_train': 1, 'symm_eval': 1}
2021-07-05 23:49:44,893 [INFO] Requested CUDA but it is not available, running on CPU
2021-07-05 23:50:43,055 [INFO] MATRES Preprocessing took 0:00:58
2021-07-05 23:50:43,056 [INFO] MATRES training instance num: 111110, valid instance num: 22892, test instance num: 2843
2021-07-05 23:50:43,056 [INFO] debug mode on
2021-07-05 23:50:46,253 [INFO] loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-config.json from cache at /Users/ehwang/.cache/torch/transformers/e1a2a406b5a05063c31f4dfdee7608986ba7c6393f7f79db5e69dcd197208534.117c81977c5979de8c088352e74ec6e70f5c66096c28b61d3c50101609b39690
2021-07-05 23:50:46,254 [INFO] Model config RobertaConfig {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-07-05 23:50:47,114 [INFO] loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-pytorch_model.bin from cache at /Users/ehwang/.cache/torch/transformers/228756ed15b6d200d7cb45aaef08c087e2706f54cb912863d2efe07c89584eb7.49b88ba7ec2c26a7558dda98ca3884c3b80fa31cf43a1b1f23aef3ff81ba344e
2021-07-05 23:50:50,033 [INFO] ======== Epoch 1 / 10 ========
2021-07-05 23:50:50,033 [INFO] Training start...
2021-07-05 23:55:18,419 [INFO] epoch: 1, loss: 281.679136
2021-07-05 23:55:18,421 [INFO] [valid-matres] start... 
2021-07-05 23:58:20,198 [INFO] confusion_matrix: 
[[13  0  0]
 [42  0  0]
 [45  0  0]]
2021-07-05 23:58:20,210 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.13      1.00      0.23        13
          01       0.00      0.00      0.00        42
          10       0.00      0.00      0.00        45

    accuracy                           0.13       100
   macro avg       0.04      0.33      0.08       100
weighted avg       0.02      0.13      0.03       100

2021-07-05 23:58:20,210 [INFO] done!
2021-07-05 23:58:20,424 [INFO] # of 10 labels: 45
2021-07-05 23:58:20,614 [INFO] # of 01 labels: 42
2021-07-05 23:58:20,854 [INFO] # of 11 labels: 0
2021-07-05 23:58:21,039 [INFO] # of 00 labels: 13
2021-07-05 23:58:21,040 [INFO] [cv-valid-matres] start... 
2021-07-06 00:01:24,032 [INFO] [cv-valid-matres] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 0, ('11', '11', '00'): 0, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 0, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 0, ('00', '11', '01'): 0, ('00', '11', '11'): 0}
2021-07-06 00:01:24,032 [INFO] [cv-valid-matres] all_cases: {('10', '10'): 0, ('10', '01'): 0, ('10', '11'): 0, ('10', '00'): 0, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 0, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 0, ('11', '00'): 0, ('00', '10'): 0, ('00', '01'): 0, ('00', '11'): 0, ('00', '00'): 100}
2021-07-06 00:01:24,035 [INFO] confusion_matrix: 
[[13  0  0]
 [42  0  0]
 [45  0  0]]
2021-07-06 00:01:24,042 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.13      1.00      0.23        13
          01       0.00      0.00      0.00        42
          10       0.00      0.00      0.00        45

    accuracy                           0.13       100
   macro avg       0.04      0.33      0.08       100
weighted avg       0.02      0.13      0.03       100

2021-07-06 00:01:24,042 [INFO] done!
2021-07-06 00:01:24,043 [INFO] valid_metrics: {'[valid-matres] Precision': nan, '[valid-matres] Recall': 0.0, '[valid-matres] F1 Score': nan, '[valid] Elapsed Time': 181.78889203071594}
2021-07-06 00:01:24,043 [INFO] cv_valid_metrics: {'[cv-valid-matres] Precision': nan, '[cv-valid-matres] Recall': 0.0, '[cv-valid-matres] F1 Score': nan, '[cv-valid] Elapsed Time': 183.001633644104}
2021-07-06 00:01:24,044 [INFO] ======== Epoch 2 / 10 ========
2021-07-06 00:01:24,044 [INFO] Training start...
