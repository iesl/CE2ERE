2021-07-04 09:29:31,934 [INFO] {'data_dir': '../data', 'no_cuda': False, 'debug': True, 'log_batch_size': 7, 'epochs': 10, 'data_type': 'hieve', 'finetune': False, 'model': 'box', 'downsample': 0.4, 'learning_rate': 0.01, 'lambda_anno': 1.0, 'lambda_trans': 0.0, 'lambda_cross': 0.0, 'volume_temp': 1.0, 'intersection_temp': 0.0001, 'hieve_threshold': -0.5902, 'matres_threshold': -0.5, 'mlp_size': 32, 'mlp_output_dim': 32, 'hieve_mlp_size': 64, 'matres_mlp_size': 32, 'proj_output_dim': 32, 'num_layers': 1, 'roberta_hidden_size': 1024, 'lstm_hidden_size': 256, 'lstm_input_size': 768, 'no_valid': False, 'loss_type': 0, 'patience': 8, 'eval_step': 1, 'eval_type': 'one', 'load_model': 0, 'saved_model': '/Users/ehwang/PycharmProjects/CE2ERE/src/model/matres_20210505163300_2ya6wb7v.pt', 'wandb_id': 'hwang7520/CE2ERE-src/2ya6wb7v', 'load_valid': 0, 'save_plot': 0}
2021-07-04 09:29:31,934 [INFO] Requested CUDA but it is not available, running on CPU
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:20,  4.76it/s]  2%|▏         | 2/100 [00:00<00:20,  4.82it/s]  3%|▎         | 3/100 [00:00<00:20,  4.67it/s]  4%|▍         | 4/100 [00:00<00:17,  5.38it/s]  5%|▌         | 5/100 [00:01<00:24,  3.95it/s]  6%|▌         | 6/100 [00:01<00:24,  3.83it/s]  7%|▋         | 7/100 [00:01<00:20,  4.54it/s]  8%|▊         | 8/100 [00:03<00:59,  1.56it/s] 10%|█         | 10/100 [00:03<00:47,  1.91it/s] 11%|█         | 11/100 [00:04<00:52,  1.71it/s] 13%|█▎        | 13/100 [00:04<00:37,  2.30it/s] 14%|█▍        | 14/100 [00:05<00:38,  2.22it/s] 15%|█▌        | 15/100 [00:05<00:31,  2.68it/s] 16%|█▌        | 16/100 [00:05<00:25,  3.33it/s] 18%|█▊        | 18/100 [00:06<00:34,  2.41it/s] 19%|█▉        | 19/100 [00:06<00:27,  2.99it/s] 20%|██        | 20/100 [00:07<00:38,  2.07it/s] 21%|██        | 21/100 [00:08<00:42,  1.86it/s] 22%|██▏       | 22/100 [00:08<00:32,  2.42it/s] 23%|██▎       | 23/100 [00:08<00:26,  2.95it/s] 24%|██▍       | 24/100 [00:08<00:20,  3.63it/s] 25%|██▌       | 25/100 [00:09<00:25,  2.97it/s] 27%|██▋       | 27/100 [00:09<00:19,  3.65it/s] 29%|██▉       | 29/100 [00:09<00:17,  4.01it/s] 30%|███       | 30/100 [00:10<00:15,  4.61it/s] 31%|███       | 31/100 [00:10<00:25,  2.67it/s] 32%|███▏      | 32/100 [00:10<00:21,  3.22it/s] 33%|███▎      | 33/100 [00:11<00:27,  2.48it/s] 34%|███▍      | 34/100 [00:11<00:22,  2.95it/s] 35%|███▌      | 35/100 [00:12<00:29,  2.21it/s] 36%|███▌      | 36/100 [00:12<00:22,  2.83it/s] 37%|███▋      | 37/100 [00:12<00:21,  2.89it/s] 38%|███▊      | 38/100 [00:13<00:20,  2.97it/s] 39%|███▉      | 39/100 [00:13<00:16,  3.73it/s] 40%|████      | 40/100 [00:13<00:13,  4.51it/s] 41%|████      | 41/100 [00:13<00:11,  5.16it/s] 43%|████▎     | 43/100 [00:13<00:09,  5.88it/s] 45%|████▌     | 45/100 [00:14<00:08,  6.14it/s] 46%|████▌     | 46/100 [00:14<00:11,  4.56it/s] 48%|████▊     | 48/100 [00:14<00:09,  5.73it/s] 50%|█████     | 50/100 [00:14<00:08,  6.23it/s] 51%|█████     | 51/100 [00:18<00:53,  1.10s/it] 52%|█████▏    | 52/100 [00:18<00:40,  1.19it/s] 53%|█████▎    | 53/100 [00:18<00:30,  1.55it/s] 54%|█████▍    | 54/100 [00:18<00:22,  2.06it/s] 55%|█████▌    | 55/100 [00:18<00:16,  2.65it/s] 56%|█████▌    | 56/100 [00:18<00:13,  3.36it/s] 58%|█████▊    | 58/100 [00:19<00:09,  4.45it/s] 60%|██████    | 60/100 [00:19<00:08,  4.96it/s] 61%|██████    | 61/100 [00:19<00:08,  4.58it/s] 62%|██████▏   | 62/100 [00:19<00:08,  4.50it/s] 63%|██████▎   | 63/100 [00:20<00:09,  3.99it/s] 65%|██████▌   | 65/100 [00:20<00:07,  4.56it/s] 66%|██████▌   | 66/100 [00:20<00:07,  4.45it/s] 67%|██████▋   | 67/100 [00:21<00:10,  3.22it/s] 68%|██████▊   | 68/100 [00:21<00:11,  2.85it/s] 70%|███████   | 70/100 [00:21<00:08,  3.73it/s] 71%|███████   | 71/100 [00:21<00:06,  4.55it/s] 73%|███████▎  | 73/100 [00:22<00:05,  5.28it/s] 74%|███████▍  | 74/100 [00:22<00:04,  5.59it/s] 77%|███████▋  | 77/100 [00:23<00:05,  4.45it/s] 78%|███████▊  | 78/100 [00:23<00:04,  5.29it/s] 80%|████████  | 80/100 [00:23<00:03,  6.34it/s] 83%|████████▎ | 83/100 [00:23<00:02,  7.18it/s] 84%|████████▍ | 84/100 [00:23<00:02,  7.70it/s] 85%|████████▌ | 85/100 [00:24<00:02,  7.31it/s] 87%|████████▋ | 87/100 [00:24<00:01,  8.87it/s] 89%|████████▉ | 89/100 [00:24<00:01,  8.97it/s] 91%|█████████ | 91/100 [00:28<00:05,  1.53it/s] 92%|█████████▏| 92/100 [00:29<00:06,  1.24it/s] 94%|█████████▍| 94/100 [00:30<00:04,  1.36it/s] 95%|█████████▌| 95/100 [00:30<00:02,  1.78it/s] 96%|█████████▌| 96/100 [00:30<00:01,  2.32it/s] 97%|█████████▋| 97/100 [00:30<00:01,  2.99it/s] 99%|█████████▉| 99/100 [00:32<00:00,  2.42it/s]100%|██████████| 100/100 [00:34<00:00,  1.07it/s]100%|██████████| 100/100 [00:34<00:00,  2.91it/s]
2021-07-04 09:30:06,291 [INFO] HiEve Preprocessing took 0:00:34
2021-07-04 09:30:06,291 [INFO] HiEve training instance num: 32876, valid instance num: 7670, test instance num: 5560
2021-07-04 09:30:06,292 [INFO] debug mode on
2021-07-04 09:30:06,648 [INFO] hieve length debugging mode: %d
2021-07-04 09:30:06,721 [DEBUG] Starting new HTTPS connection (1): s3.amazonaws.com:443
2021-07-04 09:30:07,579 [DEBUG] https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/roberta-base-config.json HTTP/1.1" 200 0
2021-07-04 09:30:07,582 [INFO] loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-config.json from cache at /Users/ehwang/.cache/torch/transformers/e1a2a406b5a05063c31f4dfdee7608986ba7c6393f7f79db5e69dcd197208534.117c81977c5979de8c088352e74ec6e70f5c66096c28b61d3c50101609b39690
2021-07-04 09:30:07,582 [INFO] Model config RobertaConfig {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-07-04 09:30:07,585 [DEBUG] Starting new HTTPS connection (1): s3.amazonaws.com:443
2021-07-04 09:30:08,452 [DEBUG] https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/roberta-base-pytorch_model.bin HTTP/1.1" 200 0
2021-07-04 09:30:08,457 [INFO] loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-base-pytorch_model.bin from cache at /Users/ehwang/.cache/torch/transformers/228756ed15b6d200d7cb45aaef08c087e2706f54cb912863d2efe07c89584eb7.49b88ba7ec2c26a7558dda98ca3884c3b80fa31cf43a1b1f23aef3ff81ba344e
Using OneThresholdEvaluator..!
2021-07-04 09:30:11,186 [INFO] ======== Epoch 1 / 10 ========
2021-07-04 09:30:11,186 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:42<00:00, 42.13s/it]100%|██████████| 1/1 [00:42<00:00, 42.13s/it]
2021-07-04 09:30:53,317 [INFO] epoch: 1, loss: 284.414318
2021-07-04 09:30:53,318 [INFO] [valid-hieve] start... 
2021-07-04 09:31:32,973 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
/Users/ehwang/PycharmProjects/CE2ERE/src/metrics.py:119: RuntimeWarning: invalid value encountered in long_scalars
  P = P_numerator/P_denominator
/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
2021-07-04 09:31:32,983 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:31:32,983 [INFO] macro f1 score: 0.0000
2021-07-04 09:31:32,984 [INFO] done!
2021-07-04 09:31:32,988 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:32:08,270 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 0, ('11', '11', '00'): 0, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 0, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 0, ('00', '11', '01'): 0, ('00', '11', '11'): 0}
2021-07-04 09:32:08,270 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 0, ('10', '11'): 0, ('10', '00'): 0, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 0, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 0, ('11', '00'): 0, ('00', '10'): 0, ('00', '01'): 0, ('00', '11'): 5, ('00', '00'): 95}
2021-07-04 09:32:08,272 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
2021-07-04 09:32:08,279 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:32:08,279 [INFO] macro f1 score: 0.0000
2021-07-04 09:32:08,279 [INFO] done!
2021-07-04 09:32:08,282 [INFO] valid_metrics: {'[valid-hieve] Precision': nan, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 39.6655158996582}
2021-07-04 09:32:08,282 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': nan, '[cv-valid-hieve] Recall': 0.0, '[cv-valid-hieve] F1 Score': nan, '[cv-valid] Elapsed Time': 35.29149603843689}
2021-07-04 09:32:08,283 [INFO] ======== Epoch 2 / 10 ========
2021-07-04 09:32:08,283 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:39<00:00, 39.71s/it]100%|██████████| 1/1 [00:39<00:00, 39.71s/it]
2021-07-04 09:32:47,996 [INFO] epoch: 2, loss: 244.652246
2021-07-04 09:32:47,997 [INFO] [valid-hieve] start... 
2021-07-04 09:33:22,986 [INFO] confusion_matrix: 
[[28  0  0  4]
 [20  0  0  3]
 [14  0  0 17]
 [14  0  0  0]]
/Users/ehwang/PycharmProjects/CE2ERE/src/metrics.py:121: RuntimeWarning: invalid value encountered in double_scalars
  F1 = 2 * P * R / (P + R)
2021-07-04 09:33:22,993 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.37      0.88      0.52        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.28       100
   macro avg       0.09      0.22      0.13       100
weighted avg       0.12      0.28      0.17       100

2021-07-04 09:33:22,993 [INFO] macro f1 score: 0.0000
2021-07-04 09:33:22,993 [INFO] done!
2021-07-04 09:33:22,997 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:33:57,445 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 3, ('11', '11', '00'): 2, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 1, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 0, ('00', '11', '01'): 1, ('00', '11', '11'): 0}
2021-07-04 09:33:57,445 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 0, ('10', '11'): 0, ('10', '00'): 0, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 0, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 9, ('11', '00'): 15, ('00', '10'): 0, ('00', '01'): 0, ('00', '11'): 31, ('00', '00'): 45}
2021-07-04 09:33:57,447 [INFO] confusion_matrix: 
[[28  0  0  4]
 [20  0  0  3]
 [14  0  0 17]
 [14  0  0  0]]
2021-07-04 09:33:57,453 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.37      0.88      0.52        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.28       100
   macro avg       0.09      0.22      0.13       100
weighted avg       0.12      0.28      0.17       100

2021-07-04 09:33:57,453 [INFO] macro f1 score: 0.0000
2021-07-04 09:33:57,454 [INFO] done!
2021-07-04 09:33:57,457 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.0, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 34.99623203277588}
2021-07-04 09:33:57,457 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': 0.0, '[cv-valid-hieve] Recall': 0.0, '[cv-valid-hieve] F1 Score': nan, '[cv-valid] Elapsed Time': 34.45646691322327}
2021-07-04 09:33:57,458 [INFO] ======== Epoch 3 / 10 ========
2021-07-04 09:33:57,458 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:41<00:00, 41.25s/it]100%|██████████| 1/1 [00:41<00:00, 41.25s/it]
2021-07-04 09:34:38,712 [INFO] epoch: 3, loss: 218.649775
2021-07-04 09:34:38,713 [INFO] [valid-hieve] start... 
2021-07-04 09:35:15,838 [INFO] confusion_matrix: 
[[19  1  6  6]
 [14  0  6  3]
 [14  0  0 17]
 [ 7  0  0  7]]
2021-07-04 09:35:15,845 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.35      0.59      0.44        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.21      0.50      0.30        14

    accuracy                           0.26       100
   macro avg       0.14      0.27      0.18       100
weighted avg       0.14      0.26      0.18       100

2021-07-04 09:35:15,845 [INFO] macro f1 score: 0.0000
2021-07-04 09:35:15,845 [INFO] done!
2021-07-04 09:35:15,850 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:35:52,202 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 6, ('10', '11', '00'): 1, ('10', '00', '01'): 1, ('10', '00', '11'): 2, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 1, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 2, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 4, ('11', '11', '10'): 0, ('11', '11', '01'): 1, ('11', '11', '00'): 3, ('11', '00', '10'): 0, ('11', '00', '01'): 2, ('11', '00', '11'): 0, ('00', '10', '01'): 0, ('00', '10', '11'): 3, ('00', '01', '10'): 1, ('00', '01', '11'): 2, ('00', '11', '10'): 10, ('00', '11', '01'): 1, ('00', '11', '11'): 2}
2021-07-04 09:35:52,202 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 1, ('10', '11'): 8, ('10', '00'): 3, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 1, ('01', '00'): 0, ('11', '10'): 4, ('11', '01'): 4, ('11', '11'): 11, ('11', '00'): 14, ('00', '10'): 7, ('00', '01'): 5, ('00', '11'): 35, ('00', '00'): 7}
2021-07-04 09:35:52,204 [INFO] confusion_matrix: 
[[19  1  6  6]
 [14  0  6  3]
 [14  0  0 17]
 [ 7  0  0  7]]
2021-07-04 09:35:52,212 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.35      0.59      0.44        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.21      0.50      0.30        14

    accuracy                           0.26       100
   macro avg       0.14      0.27      0.18       100
weighted avg       0.14      0.26      0.18       100

2021-07-04 09:35:52,212 [INFO] macro f1 score: 0.0000
2021-07-04 09:35:52,212 [INFO] done!
2021-07-04 09:35:52,216 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.15217391304347827, '[valid-hieve] Recall': 0.10294117647058823, '[valid-hieve] F1 Score': 0.12280701754385966, '[valid] Elapsed Time': 37.13298296928406}
2021-07-04 09:35:52,217 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': 0.15217391304347827, '[cv-valid-hieve] Recall': 0.10294117647058823, '[cv-valid-hieve] F1 Score': 0.12280701754385966, '[cv-valid] Elapsed Time': 36.36275386810303}
2021-07-04 09:35:52,401 [INFO] model is saved here: ./model/hieve_20210704093011_16a1af48.pt, best epoch: 3, best f1 score: 0.122807
2021-07-04 09:35:52,402 [INFO] ======== Epoch 4 / 10 ========
2021-07-04 09:35:52,402 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:41<00:00, 41.96s/it]100%|██████████| 1/1 [00:41<00:00, 41.96s/it]
2021-07-04 09:36:34,364 [INFO] epoch: 4, loss: 152.373251
2021-07-04 09:36:34,365 [INFO] [valid-hieve] start... 
2021-07-04 09:37:10,181 [INFO] confusion_matrix: 
[[28  1  2  1]
 [20  0  0  3]
 [31  0  0  0]
 [ 7  0  7  0]]
2021-07-04 09:37:10,188 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.33      0.88      0.47        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.28       100
   macro avg       0.08      0.22      0.12       100
weighted avg       0.10      0.28      0.15       100

2021-07-04 09:37:10,188 [INFO] macro f1 score: 0.0000
2021-07-04 09:37:10,188 [INFO] done!
2021-07-04 09:37:10,192 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:37:50,441 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 0, ('11', '11', '00'): 0, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 1, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 1, ('00', '11', '01'): 0, ('00', '11', '11'): 0}
2021-07-04 09:37:50,441 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 1, ('10', '11'): 0, ('10', '00'): 8, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 1, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 1, ('11', '00'): 3, ('00', '10'): 2, ('00', '01'): 12, ('00', '11'): 18, ('00', '00'): 54}
2021-07-04 09:37:50,443 [INFO] confusion_matrix: 
[[28  1  2  1]
 [20  0  0  3]
 [31  0  0  0]
 [ 7  0  7  0]]
2021-07-04 09:37:50,450 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.33      0.88      0.47        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.28       100
   macro avg       0.08      0.22      0.12       100
weighted avg       0.10      0.28      0.15       100

2021-07-04 09:37:50,451 [INFO] macro f1 score: 0.0000
2021-07-04 09:37:50,451 [INFO] done!
2021-07-04 09:37:50,454 [INFO] valid_metrics: {'[valid-hieve] Precision': 0.0, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 35.822826862335205}
2021-07-04 09:37:50,454 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': 0.0, '[cv-valid-hieve] Recall': 0.0, '[cv-valid-hieve] F1 Score': nan, '[cv-valid] Elapsed Time': 40.25933790206909}
2021-07-04 09:37:50,455 [INFO] ======== Epoch 5 / 10 ========
2021-07-04 09:37:50,455 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:42<00:00, 42.63s/it]100%|██████████| 1/1 [00:42<00:00, 42.63s/it]
2021-07-04 09:38:33,083 [INFO] epoch: 5, loss: 141.559870
2021-07-04 09:38:33,085 [INFO] [valid-hieve] start... 
2021-07-04 09:39:12,642 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
2021-07-04 09:39:12,648 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:39:12,648 [INFO] macro f1 score: 0.0000
2021-07-04 09:39:12,649 [INFO] done!
2021-07-04 09:39:12,652 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:39:47,254 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 0, ('11', '11', '00'): 0, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 0, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 0, ('00', '11', '01'): 0, ('00', '11', '11'): 1}
2021-07-04 09:39:47,254 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 0, ('10', '11'): 0, ('10', '00'): 0, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 0, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 0, ('11', '00'): 0, ('00', '10'): 6, ('00', '01'): 1, ('00', '11'): 10, ('00', '00'): 83}
2021-07-04 09:39:47,256 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
2021-07-04 09:39:47,262 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:39:47,262 [INFO] macro f1 score: 0.0000
2021-07-04 09:39:47,262 [INFO] done!
2021-07-04 09:39:47,266 [INFO] valid_metrics: {'[valid-hieve] Precision': nan, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 39.56415271759033}
2021-07-04 09:39:47,266 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': nan, '[cv-valid-hieve] Recall': 0.0, '[cv-valid-hieve] F1 Score': nan, '[cv-valid] Elapsed Time': 34.61027908325195}
2021-07-04 09:39:47,267 [INFO] ======== Epoch 6 / 10 ========
2021-07-04 09:39:47,267 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:40<00:00, 40.46s/it]100%|██████████| 1/1 [00:40<00:00, 40.46s/it]
2021-07-04 09:40:27,728 [INFO] epoch: 6, loss: 150.554306
2021-07-04 09:40:27,730 [INFO] [valid-hieve] start... 
2021-07-04 09:41:03,620 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
2021-07-04 09:41:03,627 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:41:03,627 [INFO] macro f1 score: 0.0000
2021-07-04 09:41:03,627 [INFO] done!
2021-07-04 09:41:03,631 [INFO] [cv-valid-hieve] start... 
2021-07-04 09:41:38,801 [INFO] [cv-valid-hieve] constraint-violation: {('10', '10', '01'): 0, ('10', '10', '11'): 0, ('10', '10', '00'): 0, ('10', '11', '01'): 0, ('10', '11', '11'): 0, ('10', '11', '00'): 0, ('10', '00', '01'): 0, ('10', '00', '11'): 0, ('01', '01', '10'): 0, ('01', '01', '11'): 0, ('01', '01', '00'): 0, ('01', '11', '10'): 0, ('01', '11', '11'): 0, ('01', '11', '00'): 0, ('01', '00', '10'): 0, ('01', '00', '11'): 0, ('11', '10', '01'): 0, ('11', '10', '11'): 0, ('11', '10', '00'): 0, ('11', '01', '10'): 0, ('11', '01', '11'): 0, ('11', '01', '00'): 0, ('11', '11', '10'): 0, ('11', '11', '01'): 0, ('11', '11', '00'): 0, ('11', '00', '10'): 0, ('11', '00', '01'): 0, ('11', '00', '11'): 0, ('00', '10', '01'): 0, ('00', '10', '11'): 0, ('00', '01', '10'): 0, ('00', '01', '11'): 0, ('00', '11', '10'): 0, ('00', '11', '01'): 0, ('00', '11', '11'): 0}
2021-07-04 09:41:38,801 [INFO] [cv-valid-hieve] all_cases: {('10', '10'): 0, ('10', '01'): 0, ('10', '11'): 0, ('10', '00'): 0, ('01', '10'): 0, ('01', '01'): 0, ('01', '11'): 0, ('01', '00'): 0, ('11', '10'): 0, ('11', '01'): 0, ('11', '11'): 0, ('11', '00'): 0, ('00', '10'): 5, ('00', '01'): 0, ('00', '11'): 7, ('00', '00'): 88}
2021-07-04 09:41:38,803 [INFO] confusion_matrix: 
[[32  0  0  0]
 [23  0  0  0]
 [31  0  0  0]
 [14  0  0  0]]
2021-07-04 09:41:38,809 [INFO] classifiction_report: 
              precision    recall  f1-score   support

          00       0.32      1.00      0.48        32
          01       0.00      0.00      0.00        23
          10       0.00      0.00      0.00        31
          11       0.00      0.00      0.00        14

    accuracy                           0.32       100
   macro avg       0.08      0.25      0.12       100
weighted avg       0.10      0.32      0.16       100

2021-07-04 09:41:38,809 [INFO] macro f1 score: 0.0000
2021-07-04 09:41:38,810 [INFO] done!
2021-07-04 09:41:38,813 [INFO] valid_metrics: {'[valid-hieve] Precision': nan, '[valid-hieve] Recall': 0.0, '[valid-hieve] F1 Score': nan, '[valid] Elapsed Time': 35.897515058517456}
2021-07-04 09:41:38,813 [INFO] cv_valid_metrics: {'[cv-valid-hieve] Precision': nan, '[cv-valid-hieve] Recall': 0.0, '[cv-valid-hieve] F1 Score': nan, '[cv-valid] Elapsed Time': 35.178875207901}
2021-07-04 09:41:38,813 [INFO] ======== Epoch 7 / 10 ========
2021-07-04 09:41:38,814 [INFO] Training start...
  0%|          | 0/1 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/Users/ehwang/PycharmProjects/CE2ERE/src/__main__.py", line 258, in <module>
    main()
  File "/Users/ehwang/PycharmProjects/CE2ERE/src/__main__.py", line 254, in main
    trainer.train()
  File "/Users/ehwang/PycharmProjects/CE2ERE/src/train.py", line 110, in train
    vol_A_B, vol_B_A, _, _, _, _ = self.model(batch, device, self.data_type) # [batch_size, # of datasets]
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/PycharmProjects/CE2ERE/src/model.py", line 386, in forward
    roberta_y_sntc = self._get_roberta_embedding(y_sntc)
  File "/Users/ehwang/PycharmProjects/CE2ERE/src/model.py", line 375, in _get_roberta_embedding
    roberta_embd = self.RoBERTa_layer(s.unsqueeze(0))[0] # [1, 120, 768]
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/transformers/modeling_bert.py", line 790, in forward
    encoder_attention_mask=encoder_extended_attention_mask,
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/transformers/modeling_bert.py", line 407, in forward
    hidden_states, attention_mask, head_mask[i], encoder_hidden_states, encoder_attention_mask
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/transformers/modeling_bert.py", line 379, in forward
    intermediate_output = self.intermediate(attention_output)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/transformers/modeling_bert.py", line 331, in forward
    hidden_states = self.dense(hidden_states)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 87, in forward
    return F.linear(input, self.weight, self.bias)
  File "/Users/ehwang/opt/anaconda3/envs/conda-env/lib/python3.7/site-packages/torch/nn/functional.py", line 1372, in linear
    output = input.matmul(weight.t())
KeyboardInterrupt
  0%|          | 0/1 [00:14<?, ?it/s]
